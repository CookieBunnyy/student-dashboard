<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Student Performance</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='performance.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="flickering-background"></div>
    <div class="sidebar">
      <a href="{{ url_for('dashboard') }}" class="nav-link">Back to Dashboard</a>
       
    </div>
   
    <div class="container">
        <h2>Student Performance Overview</h2>
        <canvas id="performanceChart" width="400" height="200"></canvas>
        
    </div>

    <div class="theme-selector" id="color-theme">
        <label>Choose your theme:</label>
        <div class="color-theme">
            <button class="theme-btn" id="default" style="background-color:rgb(38, 38, 38);" title="Default" onclick="changeThemeById('default')"></button>
            <button class="theme-btn" id="gray" style="background-color: #7f8c8d;" title="Gray" onclick="changeThemeById('gray')"></button>
            <button class="theme-btn" id="light" style="background-color:rgb(145, 233, 255);" title="Light" onclick="changeThemeById('light')"></button>
            <button class="theme-btn" id="ocean" style="background-color: #3498db;" title="Ocean" onclick="changeThemeById('ocean')"></button>
            <button class="theme-btn" id="sunset" style="background-color:rgb(245, 170, 104);" title="Sunset" onclick="changeThemeById('sunset')"></button>
            <button class="theme-btn" id="forest" style="background-color: #27ae60;" title="Forest" onclick="changeThemeById('forest')"></button>
            <button class="theme-btn" id="blossom" style="background-color:rgb(255, 52, 127);" title="Cherry Blossom" onclick="changeThemeById('blossom')"></button>
        </div>
    </div>
    <script>
         // Function to get the current CSS variable value
  function getCSSVar(name) {
    return getComputedStyle(document.documentElement).getPropertyValue(name).trim();
  }

  // Get dynamic color from CSS variable
  const barColor = getCSSVar('--bar-color');

  const data = {
    labels: {{ labels | tojson }},
    datasets: [{
      label: 'Performance (%)',
      data: {{ performance_data | tojson }},
      backgroundColor: barColor,  // Use the CSS variable
      borderColor: 'rgba(0, 0, 0, 0.2)',
      borderWidth: 1
    }]
  };

  const config = {
    type: 'bar',
    data: data,
    options: {
      scales: {
        y: { beginAtZero: true, max: 100 }
      }
    }
  };

  const performanceChart = new Chart(
    document.getElementById('performanceChart'),
    config
  );

  // Optional: When theme changes, update chart color
  document.getElementById('color-theme').addEventListener('click', () => {
    const newColor = getCSSVar('--bar-color');
    performanceChart.data.datasets[0].backgroundColor = newColor;
    performanceChart.update();
  });
  
    

        function changeThemeById(theme) {
           
            document.documentElement.setAttribute('data-theme', theme);
        
            
            localStorage.setItem('theme', theme);
        }
        

        window.onload = function () {
            const savedTheme = localStorage.getItem('theme') || 'default';
            document.documentElement.setAttribute('data-theme', savedTheme);
        
          
            const buttons = document.querySelectorAll('#color-theme .theme-btn');
            buttons.forEach(btn => {
                if (btn.id === savedTheme) {
                    btn.classList.add('active-theme');
                } else {
                    btn.classList.remove('active-theme');
                }
            });
        };
        
        document.addEventListener("DOMContentLoaded", function () {
          const navLinks = document.querySelectorAll("a.nav-link, button.nav-button");
      
          navLinks.forEach(link => {
              link.addEventListener("click", function (e) {
                  e.preventDefault(); 
      
                  const targetUrl = this.href || this.getAttribute("data-target");
                  if (targetUrl) {
                      
                      sessionStorage.setItem("target", targetUrl);
      
                    
                      window.location.href = "/loading";
                  }
              });
          });
      });
    </script>
</body>
</html>
